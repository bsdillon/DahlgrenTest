<!DOCTYPE html>
<html>
  <head>
    <title>DataChartingAPI Documentation</title>
    <link href = "./../../common.css" rel = "stylesheet">
    <script>
      function changeType()
      {
        let t = document.getElementById("typeSelect").value;
        document.getElementById("typeText").innerHTML = t;
        document.getElementById("typeImage").src = t+"GraphExample.png";
        let allowed = ['Line', 'HBar', 'VBar', 'Area'];
        if(allowed.includes(t))
        {
          document.getElementById("typeColor").innerHTML = ", 'colorScheme': ['rgb(127,240,52)', 'rgb(64,0,174)']";
        }
        else
        {
          document.getElementById("typeColor").innerHTML = "";
        }
      }

      function changeOrientation()
      {
        let index = parseInt(document.getElementById("orientSelect").value,10)+1;
        let texts = ["HBar", "Pie", "VBar"];
        document.getElementById("orientType").innerHTML=texts[index];
        let imgs = ["HBarGraphExample3.png", "PieChartAxis.png", "VBarGraphExample3.png"];
        document.getElementById("orientImage").src = imgs[index];
      }      

      function changeDataSet()
      {
        let index = parseInt(document.getElementById("dsSelect").value,10);
        let texts = ["Line", "Line", "Scatter"];
        document.getElementById("dsType").innerHTML=texts[index];
        let texts2 = ["categoric", "numeric2", "numeric2"];
        document.getElementById("dsXdata").innerHTML = texts2[index];
        let imgs = ["categoricLine.png", "categoricLine2.png", "numericScatter.png"];
        document.getElementById("dsImage").src = imgs[index];
      }

      function updateMulti()
      {
        let index = parseInt(document.getElementById("multiSelect").value,10);
        let types = ["Line","VBar"];
        let index2 = parseInt(document.getElementById("multiSelect2").value,10);
        let types2 = ["default","multi","stacked"];
        let m = "'Multi'";
        if(index2==0)
        {
          m="";
        }

        let s = "'Stacked'";
        if(index2<2)
        {
          s="";
        }

        for(let i=0;i<3;i++)
        {
          document.getElementById("multiType"+i).innerHTML=types[index];
          document.getElementById("multi"+i).innerHTML=m;
          document.getElementById("stacked"+i).innerHTML=s;
        }
        document.getElementById("multiImage").src=types2[index2]+types[index]+"Set.png";
      }

      function updateProgressive()
      {
        let index = parseInt(document.getElementById("progressiveSelect").value,10);
        let images = ["AreaGraphExample3.png","AreaGraphProgressiveExample2.png"];
        document.getElementById("progressiveImage").src=images[index];
        let text = ["","'Progressive'"];
        document.getElementById("progressiveMode").innerHTML=text[index];
      }

      function updateTrend()
      {
        let index = parseInt(document.getElementById("trendSelect").value,10);
        let images = ["ScatterPlotTrendExample2.png","ScatterPlotTrendExample1.png"];
        document.getElementById("trendImage").src=images[index];
        let text = ["'Trend'",""];
        document.getElementById("trendMode").innerHTML=text[index];
      }

      function updateColor()
      {
        let index = parseInt(document.getElementById("colorSelect").value,10);
        let images = ["RainbowExample.png","UserExample.png"];
        document.getElementById("colorImage").src=images[index];
        var tmp = "";
        if(index==1)
        {
          tmp=", <em class='white'>'colorScheme': ['rgb(127,240,52)','rgb(64,0,174)','rgb(164,100,174)','rgb(254,150,74)']</em>";
        }

        for(let i=0;i<4;i++)
        {
          document.getElementById("colors"+i).innerHTML=tmp;
        }
      }

      function updateGroup()
      {
        let index = parseInt(document.getElementById("groupSelect").value,10);
        document.getElementById("groupImage").src="PieChartGroup"+(index+1)+".png";
        let text = ["","1","4",];
        var tmp = ", <em class='white'>'group':"+text[index]+"</em>";
        if(index==0)
        {
          tmp="";
        }
        document.getElementById("groupText").innerHTML=tmp;
      }
    </script>
  </head>
  <body>
    <h2>Data Charting API</h2>

    <h3>Table of Contents</h3>
    <ul>
      <li><a href="#importLibraries">Import Libraries</a></li>
      <li><a href="#creatingGraphs">Creating Graphs</a></li>
      <li><a href="#datasetName">Dataset Naming</a></li>
      <li>JSON parameters<br>
        <ul>
        <li><a href="#type">Chart Types</a></li>
        <li><a href="#axis">Axis Labels</a></li>
        <li><a href="#series">Series Names</a></li>
        <li><a href="#dataset">Datasets</a></li>
        <li><a href="#modes">Modes</a><br>
          <ul>
            <li><a href="#multi">Multi</a></li>
            <li><a href="#stack">Stacked</a></li>
            <li><a href="#progressive">Progressive</a></li>
            <li><a href="#trend">Trend</a></li>
          </ul>
        </li>
        <li><a href="#colors">Color Scheme</a></li>
        <li><a href="#group">Group Colors</li>
        </ul>
      </li>
    </ul>

    <div class="major">
    <a name="importLibraries"></a><h3>Importing Libraries</h3>
    <p>
      The Data Charting API is built using <a href="chartjs.org">Chart.js</a> licenses
      under <a href="chartjs.org/docs/2.9.4/notes/license.html">the MIT license</a>. 
      Chart.js <a href="https://www.chartjs.org/">Chart.js</a> is an open source 
      JavaScript library used for data visualization and creating graphs. Chart.js is 
      highly flexible with a variety of options available at the cost of an increased 
      programming burden. To alleviate some of that burden, the Data Charting API has 
      encapsulated and simplified most of those options while providing a reasonable 
      degree of flexibility. That is the tradeoff. Less overall flexibility that Chart.js, 
      but a lower learning curve to use the technology.
    </p>

    <p>
      There are several JavaScript libraries that you will need to import into your 
      code. Each library can be downloaded and linked into the HTML code of your 
      choice using the technique shown below.
    </p>
    <ul>
      <li><a href="Chart.min.js">Chart.min.js</a></li>
      <li><a href="piechartlibrary.js">piechartlibrary.js</a></li>
      <li><a href="linechartlibrary.js">linechartlibrary.js</a></li>
      <li><a href="scatterchartLibrary.js">scatterchartLibrary.js</a></li>
      <li><a href="datacharting.js">datacharting.js</a></li>
      <li><a href="chartstyle.js">chartstyle.js</a></li>
    </ul>

    <div  class="ex"><ol>
      <li>&lt;script src="Chart.min.js"&gt;&lt;/script&gt;</li>
      <li>&lt;script src="piechartlibrary.js"&gt;&lt;/script&gt;</li>
      etc...
    </ol></div>
    </div>

    <div class="major">
    <a name="creatingGraphs"></a><h3>Creating Graphs</h3>
    <p>
      All charts are created from a JSON object with a fixed set of inputs. There are
      various options, laid out in this document, but the basic structure of the JSON
      is constant. Additional efficiencies can be derived by formating the JSON as 
      a result of an external library. The example below shows the JSON object being 
      created in the JavaScript of the page.
    </p>

    <div  class="ex"><ol>
      <li>var data1 = [100, 90, 80, 70,...];</li>
      <li>var labels = ['A','B','C',...];</li>
      ...
      <li>var json = {"VAR_Example": {'type': chartType, 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample', 'x-data': labels, 'y-data': data, 'modes': ['mode'], 'colorScheme': RGB_values}};</li>
    </ol></div>

    <p>
      All charts must be created in the context of a DataCharting object. The object
      defines the size of all graphs created with that object. The DataCharting object
      can be reused, but all datasets created with the same object must have a unique
      name. This is important when dealing with <a href="multi">multiple data sets</a> 
      in a single chart. The example shown her uses a 300 pixel x 300 pixel chart size
      and is creating a chart from the VAR_Example dataset defined in the JSON object 
      above. Note that while you can define a smaller or larger size for the chart, 
      Chart.js automatically defines the scale of the axis and thus the "zoom" level
      of the chart.
    </p>

    <div  class="ex"><ol start="10">
      ...
      <li>charting = new DataCharting(300, 300);</li>
      <li>var mychart = charting.createChart(json, "VAR_Example");</li>
      ...
    </ol></div>

    <p>
      The DataCharting object uses the DOM to create a canvas tag and build the
      required chart on that tag. The <code>mychart</code> object above is that
      tag and it must be appended to an appropriate place on the page. In this 
      case, that is a cell in a table but the exact position of any chart can be
      defined by any number of means or hard-coded into an HTML page.
    </p>

    <div  class="ex"><ol start="20">
      ...
      <li>var field = document.getElementById("field");</li>
      <li>var table = document.createElement("TABLE");</li>
      <li>field.appendChild(table);</li>
      <li>var row = table.insertRow();</li>
      <li>let td = document.createElement("td");</li>
      <li>td.append(myChart);</li>
      <li>row.append(td);</li>
    </ol></div>
    </div>

    <div class="major">
    <a name="datasetName"></a><h3>Dataset Naming Requirements</h3>
    <p>
      DataCarting strips away certain information from the JSON message. As a result,
      there are certain conventions and requirements for the name of the data set which
      must be followed. There are three requirements. In all other respects the API 
      accepts all variations.
    </p>
    <dl>
      <dt>Always start with 'VAR_'</dt><dd>The leading VAR_ is mandatory and is stripped
      from the name by default.</dd>
      <div  class="ex"><ol>
        <li>var json = {"<em class='white'>VAR_</em>Example": {'type': chartType, 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample', 'x-data': labels, 'y-data': data, 'modes': ['mode']}};</li>
      </ol></div>
      <dt>Include '_' for spaces</dt><dd>The API will reverse the process to find the 
      title of the chart.</dd>
      <div  class="ex"><ol>
        <li>var json = {"VAR_<em class='white'>Other_Name</em>": {'type': chartType, 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample', 'x-data': labels, 'y-data': data, 'modes': ['mode']}};</li>
      </ol></div>
      <dt>Exclude '-' from names</dt><dd>The API looks for '-#' at the end of the name 
      for <a href="multi">multiple data sets</a>. Avoid use of this character.</dd>
      <div  class="ex"><ol>
        <li>var json = {"VAR_Multi_Set<em class='white'>-0</em>": {'type': chartType, 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample', 'x-data': labels, 'y-data': data, 'modes': ['mode']}};</li>
      </ol></div>
    </dl>
    </div>
    </br>

    <div class="major">
    <a name="type"></a><h3>Type</h3>
    <p class>
      The <code>type</code> parameter dictates the kind of graph. The options are line 
      graph, bar graph (vertical and horizontal), area graph, pie graph and scatter plot.
      Chart.js actually allows multiple types to be joined, but for the sake of simplicity
      DataCharting only allows one type per chart.
    </p>
    <select onchange="changeType()" id="typeSelect">
      <option value="Line">Line</option>
      <option value="VBar">Vertical Bars</option>
      <option value="HBar">Horizontal Bars</option>
      <option value="Area">Area Chart</option>
      <option value="Pie">Pie Chart</option>
      <option value="Scatter">Scatter Plot</option>
    </select>

    <div class="ex">
    <img id="typeImage" src="LineGraphExample.png" class="float">
    <ol>
      <li>var json = {'VAR_Example': {<em class='white'>'type': '<span id="typeText">Line</span>'</em>, 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample', 'x-data': labels, 'y-data': data, 'modes': []<span id="typeColor">, 'colorScheme': ['rgb(127,240,52)', 'rgb(64,0,174)']</span>}};</li>
    </ol>
    <br clear="all">
    </div>
    </div>

    <div class="major">
    <a name="axis"></a><h3>Axis Label Orientation</h3>
    <p>
      The <code>x-axis</code> and <code>y-axis</code> parameters define the labels of the
      x and y-axis. In the normal orientation (typical of vertical bar, line, area, and
      scatter plots), the x-axis is horizontal and the y-axis is vertical. In the reflected
      orientation (only found in horizontal bar graphs), this orientation is reversed. Of
      course, in the case of a Pie chart, neither axis is meaningful.
    </p>
    <select onchange="changeOrientation()" id="orientSelect">
      <option value="1">Normal</option>
      <option value="-1">Reflected</option>
      <option value="0">None</option>
    </select>

    <div class="ex">
      <img id="orientImage" src="VBarGraphExample3.png" class="float">
      <ol>
        <li>var json = {'VAR_Example': {'type': '<em class='white'><span id="orientType">VBar</span></em>', <em class='white'>'x-axis': 'time'</em>, <em class='white'>'y-axis': 'position'</em>, 'series': 'sample', 'x-data': labels, 'y-data': data, 'modes': []}};</li>
      </ol>
    <br clear="all">
    </div>
    </div>

    <div class="major">
    <a name="series"></a><h3>Series</h3>
    <p>
      The title of the chart, the labels of the data points, and the name of the series 
      are completely different. The <a href="#datasetName">title</a> of the JSON object 
      appears over the chart. The labels are attached to each data point. Series, however,
      are defined for groups of datapoints and can be used to distinguish one set of data
      from another, especially for <a href="#multi">multiple data sets</a> in a single 
      The <code>series</code> parameter allows any string to be used.
    </p>
    <p>
      Note that Chart.js does allow multiple Pie charts to be defined, which might necessitate 
      multiple series, but this is NOT recommended.
    </p>

    <div class="ex">
      <img src="LineGraphExample3.png" class="float">
      <ol>
        <li>var json = {"VAR_Example-0": {'type': 'Line', 'x-axis': 'time', 'y-axis': 'position', <nobr><em class='white'>'series': 'sample 1'</em></nobr>, 'x-data': labels, 'y-data': data1, 'modes': ['Multi']},</li>
        <li><in>"VAR_Example-1": {'type': 'Line', 'x-axis': 'time', 'y-axis': 'position', <nobr><em class='white'>'series': 'sample 2'</em></nobr>, 'x-data': labels, 'y-data': data2, 'modes': ['Multi']},</in></li>
        <li><in>"VAR_Example-2": {'type': 'Line', 'x-axis': 'time', 'y-axis': 'position', <nobr><em class='white'>'series': 'sample 3'</em></nobr>, 'x-data': labels, 'y-data': data3, 'modes': ['Multi']},</in></li>
        <li><in>"VAR_Example-3": {'type': 'Line', 'x-axis': 'time', 'y-axis': 'position', <nobr><em class='white'>'series': 'sample 4'</em></nobr>, 'x-data': labels, 'y-data': data4, 'modes': ['Multi']}};</in></li>
      </ol>
    <br clear="all">
    </div>
    </div>

    <div class="major">
    <a name="dataset"></a><h3>X and Y Datasets</h3>
    <p>
      The <code>x-data</code> and <code>y-data</code> parameters define the data 
      displayed in the chart. These have different meanings in different charts. 
      The x data can be either categorical (e.g. "Red", "Heavy", "Alpha") or numerical, 
      while the y data must be numerical. This means that one might have different 
      numerical counts (y data) for "Light", "Dark", and "Medium" (x-data), but it makes 
      no sense to reverse the situation. In fact, the x data is always as categorical
      so that the x-data set [1,2,3,5,4] is perfectly valid and will NOT be reordered.
      The one exception to this rule is the scatter plot which allows only numerical data
      for either axis.
    </p>
    <p>
      In the example below, note that the line will accept categorical data or out-of-order
      numeric data for the x axis. That is because the x-data is always taken as categorical.
      In fact, the x data could contain the same label multiple times without causing a 
      conflict. Like having two "Daves" in the same room. This creates a psuedo-numeric
      scale which can be confusing if your source data has duplicates or is out of order.
      In the scatter plot, the x-data is treated as truly numeric and the order difference
      becomes aparent.
    </p>
    <select onchange="changeDataSet()" id="dsSelect">
      <option value="0">Categorical</option>
      <option value="1">Psuedo-Numerical</option>
      <option value="2">True Numerical</option>
    </select>

    <div class="ex">
      <img id="dsImage" src="categoricLine.png" class="float">
      <ol>
        <li>var numeric1 = [1,2,3,4,5,6,7,8,9,10];</li>
        <li>var numeric2 = [10,20,50,60,70,<b>40</b>,80,90,<b>30</b>,100];</li>
        <li>var categoric = ['A','B','C','D','E','F','G','H','I','J'];</li>
        <li>var json = {"VAR_Sample": {'type': '<span id="dsType">Line</span>', 'x-axis': 'X', 'y-axis': 'Y', 'series': 'sample 1', <em class='white'><nobr>'x-data': <span id="dsXdata">categoric</span>,</nobr> <nobr>'y-data': numeric1</em></nobr>, 'modes': []}}</li>
      </ol>
    <br clear="all">
    </div>
    </div>

    <div class="major">
    <a name="modes"></a><h3>Modes</h3>
    <p>
      The <code>modes</code> parameter is a list allowing a variety of option for the 
      graph. If nothing is passed in for this parameter then the graph will follow the
      default options. The options are presented below based on their default and other
      modes.
    </p>

    <p>
      The <a name="multi"></a><code>'Multi'</code> mode allows several different series
      to appear in the same chart. These must have the same title ending with a progressive
      numerical id (e.g. "VAR_Data-0", "VAR_Data-2", ect). Do not skip any numbers in the
      set. A single JSON object must contain all the data for that chart. Note that the
      x-data set for the first series is assumed for all the other series so they match.
    </p>

    <p>
      Along with multi, is an option for <a name="stack"></a><code>'Stacked'</code> data.
      This is secondary to multi as all non-multi charts look the same. With the stacked
      option on, all data is aggregated for each x-data value. The results may reveal
      overal trends or percentages of each series out of the whole.
    </p>
    <select onchange="updateMulti()" id="multiSelect">
      <option value="0">Line</option>
      <option value="1">VBar</option>
    </select>
    <select onchange="updateMulti()" id="multiSelect2">
      <option value="0">Single</option>
      <option value="1">Multi</option>
      <option value="2">Multi + Stacked</option>
    </select>

    <div class="ex">
      <img id="multiImage" src="defaultLineSet.png" class="float">
      <ol>
         <li>var json = {"VAR_Sample-0": {'type': '<em class='white'><span id="multiType0">Line</span></em>', 'x-axis': 'X', 'y-axis': 'Y', 'series': 'sample 0', 'x-data': data1[1], 'y-data': data2[1], 'modes': [<em class='white'><span id="multi0"></span><span id="stacked0"></span></em>]},</li>
         <li>        <in>"VAR_Sample-1": {'type': '<em class='white'><span id="multiType1">Line</span></em>', 'x-axis': 'X', 'y-axis': 'Y', 'series': 'sample 1', 'x-data': data1[1], 'y-data': data3[1], 'modes': [<em class='white'><span id="multi1"></span><span id="stacked1"></span></em>]},</in></li>
         <li>        <in>"VAR_Sample-2": {'type': '<em class='white'><span id="multiType2">Line</span></em>', 'x-axis': 'X', 'y-axis': 'Y', 'series': 'sample 2', 'x-data': data1[1], 'y-data': data4[1], 'modes': [<em class='white'><span id="multi2"></span><span id="stacked2"></span></em>]},</in></li>
         <li>        <in>}</in></li>
      </ol>
    <br clear="all">
    </div>

    <p>
      By default all values are considered discretely without respect to each other. If 
      <a name="progressive"></a><code>'Progressive'</code> mode the graph calculates the sum of each y-value 
      incrementally. Discrete values can show variation, but progressive values can show
      the effects of history. Progressive values can vary in a negative or positive 
      direction. The progressive mode has no impact on Pie or Scatter charts.
    </p>
    <select onchange="updateProgressive()" id="progressiveSelect">
      <option value="0">Discrete</option>
      <option value="1">Progressive</option>
    </select>

    <div class="ex">
      <img id="progressiveImage"src="AreaGraphExample3.png" class="float">
      <ol>
        <li>var json = {'VAR_Example': {'type': 'Area', 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample', 'x-data': labels, 'y-data': data, 'modes': [<em class='white'><span id="progressiveMode"></span></em>], 'colorScheme':['rgb(127,240,52)','rgb(64,0,174)']}};</li>
      </ol>
    <br clear="all">
    </div>

    <p>
      Lastly, if <a name="trend"></a><code>'Trend'</code> is passed in to the <code>mode</code> parameter on a scatter plot, then the graph will be displayed with a trend line.
    </p>
    <select onchange="updateTrend()" id="trendSelect">
      <option value="0">Trend</option>
      <option value="1">No-Trend</option>
    </select>

    <div class="ex">
      <img id="trendImage" src="ScatterPlotTrendExample2.png" class="float">
      <ol>
        <li>var json = {'VAR_Example-0': {'type': 'Scatter', 'x-axis': 'X', 'y-axis': 'Y', 'series': 'sample 1', 'x-data': data1, 'y-data': data2, 'modes': [<em class='white'><span id="trendMode">'Trend'</span></em>]}};</li>
      </ol>
    <br clear="all">
    </div>
    </div>

    <div class="major">
    <a name="colors"></a><h3>Color Scheme</h3>
    <p>
      The default <code>colorScheme</code> is a rainbow of colors from red to purple with
      a backup set of darker middle colors. The user can, however, implement a novel color
      scheme using Red-Green-Blue values. If colorScheme is included, the novel color scheme
      will be used. The same color schme is applied to all datasets, taking the color scheme
      and order from the first (i.e. the '-0') JSON object.
    </p>
    <select onchange="updateColor()" id="colorSelect">
      <option value="0">Default colors</option>
      <option value="1">User-defined colors</option>
    </select>

    <div class="ex">
      <img id="colorImage" src="RainbowExample.png" class="float">
      <ol>
        <li>var json = {"VAR_Example-0": {'type': 'Area', 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample 1', 'x-data': labels, 'y-data': data1, 'modes': ['Multi']<span id="colors0"></span>},</li>
        <li><in>"VAR_Example-1": {'type': 'Area', 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample 2', 'x-data': labels, 'y-data': data2, 'modes': ['Multi']<span id="colors1"></span>},</in></li>
        <li><in>"VAR_Example-2": {'type': 'Area', 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample 3', 'x-data': labels, 'y-data': data3, 'modes': ['Multi']<span id="colors2"></span>},</in></li>
        <li><in>"VAR_Example-3": {'type': 'Area', 'x-axis': 'time', 'y-axis': 'position', 'series': 'sample 4', 'x-data': labels, 'y-data': data4, 'modes': ['Multi']<span id="colors3"></span>};</in></li>
      </ol>
      <br clear="all">
    </div>
    </div>

    <div class="major">
    <a name="group"></a><h3>Group</h3>
    <p>
      The <code>'group'</code> parameter is another color option for graphs. The default
      <a href="#colors">color scheme</a> is based on a rainbow set and the user can define
      a novel color set. Groups of colors are shades of a single fixed color among the six
      primary and secondary RGB colors.
    </p>
    <select onchange="updateGroup()" id="groupSelect">
      <option value="0">Default colors</option>
      <option value="1">Group 1 colors</option>
      <option value="2">Group 4 colors</option>
    </select>

    <div class="ex">
      <img id="groupImage" src="PieChartGroup1.png" class="float">
      <ol>
        <li>var json = {"VAR_Sample": {'type': 'Pie', 'x-axis': 'X', 'y-axis': 'Y', 'series': 'sample 0', 'x-data': categoric, 'y-data': data2[1], 'modes': []<span id="groupText" ></span>}};</li>
      </ol>
      <br clear="all">
    </div>
    </div>
  </body>
</html>
