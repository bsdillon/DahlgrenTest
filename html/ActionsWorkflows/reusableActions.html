<!DOCTYPE html>
<html>
  <head>
    <title>Reusable Actions</title>
    <link rel="stylesheet" type="text/css" href="../common.css">
    <style>
    </style>
    <script>
    </script>
  </head>
  <body>
    <h3>List of useful actions</h3>
    <p>
      All of these actions have been used in the various workflow examples and may be useful again.
    </p>
    <h3>Checkout</h3>
    <p>
      Checkout is a standard action that copies all code from the repository into the build machine.
      This action will wipe out files that may have been created previously. Be careful to perform
      the checkout before creating any new files.<br>
      <code>
      - uses: actions/checkout@v1
      </code>
    </p>
    <h3>GitHub Push</h3>
    <p>
      GitHub Push is an action that can automatically add, update, commit, and push any changes
      to any file in the repository. To utilize this action effectively, you need to do the following:
      <ol>
        <li>Write code that will make the changes.</li>
        <li>Output the results in a data file.</li>
        <li>Provide proper syntax in the yaml file that will run the program
          and output the results automatically. You can refer to the sample snippet below.
          Note that if you wish to write the output data to a specific direcotory in the repository,
          make sure you include the path in both the <code>git add {path}/{filename}</code> command
          AND your code or the <code>run:</code> prompt (precede the path to file with the '>' character in the
          run prompt at the command to run your code). </li>
        <li>Choose when you want to run this workflow automatically using proper cron syntax.
          This <a href="https://crontab.guru/">site</a> provides a good reference on when you
          want to run this workflow.</li>
        <li> Make sure the workflow passes all tests when commiting and correct them. </li>
      </ol>
      <code>
        - name: Run code:<br>
        &nbsp;&nbsp;run: |<br>
        &nbsp;&nbsp;&nbsp;&nbsp;...<br>
        - name: Commit files<br>
        &nbsp;&nbsp;run: |<br>
        &nbsp;&nbsp;&nbsp;&nbsp;git config --local user.email "action@github.com"<br>
        &nbsp;&nbsp;&nbsp;&nbsp;git config --local user.name "GitHub Action"<br>
        &nbsp;&nbsp;&nbsp;&nbsp;git add {path}/{file_name}<br>
        &nbsp;&nbsp;&nbsp;&nbsp;git commit -m "Add changes" -a<br>
        - name: Push changes<br>
        &nbsp;&nbsp;uses: ad-m/github-push-action@master<br>
        &nbsp;&nbsp;with:<br>
        &nbsp;&nbsp;&nbsp;&nbsp;github_token: ${{ secrets.GITHUB_TOKEN }}<br>
        &nbsp;&nbsp;&nbsp;&nbsp;branch: 'KKBranch'<br>
        Note the last two lines are parameters. Other parameters and information about the GitHub Push action
        are found <a href="https://github.com/marketplace/actions/github-push">here</a>.
      </code>
    </p>
    <h3>IP v4 and v6</h3>
    <p>
      IP addresses are sometimes desired and can be accessed by this action. The value can be
      pulled out using the action and then saved to a file.<br>
      <code>
      - name: Public IP<br>
      &nbsp;&nbsp;id: ip<br>
      &nbsp;&nbsp;uses: haythem/public-ip@v1<br>
      - name: Print Public IP<br>
      &nbsp;&nbsp;run: |<br>
      &nbsp;&nbsp;&nbsp;&nbsp;echo ${{ steps.ip.outputs.ipv4 }} > IP2.txt
      </code>
    </p>
    <h3>Sleep</h3>
    <p>
      Sleep is occasionally needed to allow time for some other action to occur.
      While this is not the best way to code, the workflow syntax only allows
      sequential execution (i.e. no loops see <a href="https://github.community/t/creating-a-while-loop-in-workflow/119253">this discussion</a>) and delays can get around some of
      these limitations. The time parameter follows the <a href="https://ss64.com/bash/sleep.html">linux sleep syntax</a>.<br>
      <code>
      - name: Wait for 5 seconds<br>
      &nbsp;&nbsp;uses: jakejarvis/wait-action@master<br>
      &nbsp;&nbsp;with:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;time: '5s'
      </code>
    </p>
    <h3>Upload and Download Artifacts</h3>
    <p>
      These two actions use similar syntax to export artifacts. The path of the artifact is relative to the
      execution location on the runner. The name of the artifact will be the zip file that contains that file.<br>
      <code>
      - name: Keep output file as artifact<br>
      &nbsp;&nbsp;uses: actions/upload-artifact@v1<br>
      &nbsp;&nbsp;uses: actions/download-artifact@v1<br>
      &nbsp;&nbsp;with:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;name: file_list<br>
      &nbsp;&nbsp;&nbsp;&nbsp;path: out.txt
      </code>
    </p>
  </body>
</html>
